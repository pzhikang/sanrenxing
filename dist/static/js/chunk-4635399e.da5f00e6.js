(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4635399e"],{"048f":function(e,a,t){"use strict";t.r(a);var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"create-course"},[t("div",{staticClass:"form-container"},[t("div",{staticClass:"left-section"},[t("form",{on:{submit:function(a){return a.preventDefault(),e.createCourse(a)}}},[t("div",{staticClass:"form-group horizontal"},[t("label",{attrs:{for:"course-name"}},[e._v("课程名称")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.courseName,expression:"formData.courseName"}],attrs:{type:"text",id:"course-name",placeholder:"请输入课程名称",required:""},domProps:{value:e.formData.courseName},on:{input:function(a){a.target.composing||e.$set(e.formData,"courseName",a.target.value)}}})]),t("div",{staticClass:"form-group horizontal"},[t("label",{attrs:{for:"school-name"}},[e._v("学校名称")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.schoolName,expression:"formData.schoolName"}],attrs:{type:"text",id:"school-name",placeholder:"请输入学校名称",required:""},domProps:{value:e.formData.schoolName},on:{input:function(a){a.target.composing||e.$set(e.formData,"schoolName",a.target.value)}}})]),t("div",{staticClass:"form-group horizontal"},[t("label",{attrs:{for:"college-name"}},[e._v("学院名称")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.collegeName,expression:"formData.collegeName"}],attrs:{type:"text",id:"college-name",placeholder:"请输入学院名称",required:""},domProps:{value:e.formData.collegeName},on:{input:function(a){a.target.composing||e.$set(e.formData,"collegeName",a.target.value)}}})]),t("div",{staticClass:"form-group horizontal"},[t("label",{attrs:{for:"teacher-name"}},[e._v("授课教师")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.teacherName,expression:"formData.teacherName"}],attrs:{type:"text",id:"teacher-name",placeholder:"请输入授课教师名称",required:""},domProps:{value:e.formData.teacherName},on:{input:function(a){a.target.composing||e.$set(e.formData,"teacherName",a.target.value)}}})]),t("div",{staticClass:"form-group horizontal"},[t("label",{attrs:{for:"course-category"}},[e._v("课程分类")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.formData.courseCategory,expression:"formData.courseCategory"}],attrs:{id:"course-category",required:""},on:{change:function(a){var t=Array.prototype.filter.call(a.target.options,(function(e){return e.selected})).map((function(e){var a="_value"in e?e._value:e.value;return a}));e.$set(e.formData,"courseCategory",a.target.multiple?t:t[0])}}},[t("option",{attrs:{value:"理学"}},[e._v("理学")]),t("option",{attrs:{value:"工学"}},[e._v("工学")]),t("option",{attrs:{value:"管理学"}},[e._v("管理学")]),t("option",{attrs:{value:"文学"}},[e._v("文学")]),t("option",{attrs:{value:"教育学"}},[e._v("教育学")]),t("option",{attrs:{value:"经济学"}},[e._v("经济学")]),t("option",{attrs:{value:"哲学"}},[e._v("哲学")]),t("option",{attrs:{value:"医学"}},[e._v("医学")]),t("option",{attrs:{value:"法学"}},[e._v("法学")]),t("option",{attrs:{value:"农学"}},[e._v("农学")]),t("option",{attrs:{value:"艺术学"}},[e._v("艺术学")])])])])]),t("div",{staticClass:"right-section"},[t("div",{staticClass:"form-group"},[t("label",{staticClass:"bold-label"},[e._v("模型类型")]),t("div",{staticClass:"model-options"},[t("div",{staticClass:"model-row"},[t("label",{staticClass:"model-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.modelType,expression:"formData.modelType"}],attrs:{type:"radio",value:"deepseek",required:""},domProps:{checked:e._q(e.formData.modelType,"deepseek")},on:{change:function(a){return e.$set(e.formData,"modelType","deepseek")}}}),t("span",{staticClass:"radio-custom"}),t("span",{staticClass:"radio-label"},[e._v("deepseek")])]),t("label",{staticClass:"model-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.modelType,expression:"formData.modelType"}],attrs:{type:"radio",value:"Baichuan",required:""},domProps:{checked:e._q(e.formData.modelType,"Baichuan")},on:{change:function(a){return e.$set(e.formData,"modelType","Baichuan")}}}),t("span",{staticClass:"radio-custom"}),t("span",{staticClass:"radio-label"},[e._v("Baichuan")])]),t("label",{staticClass:"model-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.modelType,expression:"formData.modelType"}],attrs:{type:"radio",value:"DeepSeek",required:""},domProps:{checked:e._q(e.formData.modelType,"DeepSeek")},on:{change:function(a){return e.$set(e.formData,"modelType","DeepSeek")}}}),t("span",{staticClass:"radio-custom"}),t("span",{staticClass:"radio-label"},[e._v("DeepSeek")])])]),t("div",{staticClass:"model-row"},[t("label",{staticClass:"model-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.modelType,expression:"formData.modelType"}],attrs:{type:"radio",value:"Llama2",required:""},domProps:{checked:e._q(e.formData.modelType,"Llama2")},on:{change:function(a){return e.$set(e.formData,"modelType","Llama2")}}}),t("span",{staticClass:"radio-custom"}),t("span",{staticClass:"radio-label"},[e._v("Llama2")])]),t("label",{staticClass:"model-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.modelType,expression:"formData.modelType"}],attrs:{type:"radio",value:"InternLM",required:""},domProps:{checked:e._q(e.formData.modelType,"InternLM")},on:{change:function(a){return e.$set(e.formData,"modelType","InternLM")}}}),t("span",{staticClass:"radio-custom"}),t("span",{staticClass:"radio-label"},[e._v("InternLM")])]),t("label",{staticClass:"model-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.formData.modelType,expression:"formData.modelType"}],attrs:{type:"radio",value:"MiniCPM",required:""},domProps:{checked:e._q(e.formData.modelType,"MiniCPM")},on:{change:function(a){return e.$set(e.formData,"modelType","MiniCPM")}}}),t("span",{staticClass:"radio-custom"}),t("span",{staticClass:"radio-label"},[e._v("MiniCPM")])])])])]),t("div",{staticClass:"upload-area"},[t("div",{staticClass:"upload-box",on:{click:e.triggerFileInput,dragover:function(e){e.preventDefault()},drop:e.handleDrop}},[t("div",{staticClass:"upload-icon"},[t("svg",{attrs:{viewBox:"0 0 24 24",width:"48",height:"48"}},[t("path",{attrs:{fill:"#999",d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}})])]),t("p",[e._v("点击或拖拽文件上传")]),t("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{type:"file",multiple:"",accept:".pdf"},on:{change:e.handleFileChange}})]),e.files.length>0?t("div",{staticClass:"file-list"},[t("p",[e._v("已选择文件：")]),t("ul",e._l(e.files,(function(a,o){return t("li",{key:o},[e._v(" "+e._s(a.name)+" ")])})),0)]):e._e()])])]),t("div",{staticClass:"button-container"},[t("button",{attrs:{type:"submit"},on:{click:e.createCourse}},[e._v("确认编辑")]),t("button",{attrs:{type:"button"},on:{click:e.goToStudent}},[e._v("进入助教")]),e.message?t("div",{staticClass:"message"},[e._v(" "+e._s(e.message)+" ")]):e._e()])])},r=[],s=t("c7eb"),l=t("1da1"),n=t("3835"),c=(t("7db0"),t("a630"),t("b64b"),t("d3b7"),t("3ca3"),t("159b"),t("bc3a")),i=t.n(c),m={data:function(){return{formData:{courseName:this.$route.query.course_name||"",schoolName:this.$route.query.school_name||"",collegeName:this.$route.query.college_name||"",teacherName:this.$route.query.teacher_name||"",courseCategory:this.$route.query.course_category||"",modelType:this.$route.query.model_type||""},files:[],message:"",username:localStorage.getItem("username")||"default_user",allSubjectsFromCache:[],selectedCourseId:""}},created:function(){var e=this.$route.query,a=e.course_name,t=e.teacher_name,o=e.school_name,r=e.college_name,s=e.course_category,l=e.model_type;this.formData.courseName=a||"",this.formData.teacherName=t||"",this.formData.schoolName=o||"",this.formData.collegeName=r||"",this.formData.courseCategory=s||"",this.formData.modelType=l||"";try{var n=localStorage.getItem("allSubjects");n?(this.allSubjectsFromCache=JSON.parse(n),this.findTargetCourseId()):console.error("本地缓存中未找到课程列表 (allSubjects)")}catch(c){console.error("解析本地缓存课程列表失败",c)}},methods:{triggerFileInput:function(){this.$refs.fileInput.click()},handleDrop:function(e){e.preventDefault();var a=e.dataTransfer.files;this.files=Array.from(a)},handleFileChange:function(e){var a=e.target.files;this.files=Array.from(a)},findTargetCourseId:function(){var e=this,a=this.allSubjectsFromCache.find((function(a){var t=a.split("_"),o=Object(n["a"])(t,2),r=(o[0],o[1]);return r===e.formData.courseName}));a?(this.selectedCourseId=a.split("_")[0],console.log("找到匹配的课程ID:",this.selectedCourseId)):(console.error("未找到匹配的课程ID"),this.message="未找到对应的课程ID，请检查课程名称")},createCourse:function(){var e=this;return Object(l["a"])(Object(s["a"])().mark((function a(){var t,o,r,l;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(a.prev=0,e.selectedCourseId){a.next=4;break}return e.message="未找到有效的课程ID，请检查课程名称",a.abrupt("return");case 4:return t=new FormData,t.append("course_name",e.formData.courseName),t.append("school_name",e.formData.schoolName),t.append("college_name",e.formData.collegeName),t.append("teacher_name",e.formData.teacherName),t.append("course_category",e.formData.courseCategory),t.append("model_type",e.formData.modelType),t.append("username",e.username),e.files.forEach((function(e){t.append("teaching_materials",e)})),console.log("已发送的数据内容："),console.log("课程名称：".concat(e.formData.courseName)),console.log("学校名称：".concat(e.formData.schoolName)),console.log("学院名称：".concat(e.formData.collegeName)),console.log("授课教师：".concat(e.formData.teacherName)),console.log("课程类别：".concat(e.formData.courseCategory)),console.log("模型类型：".concat(e.formData.modelType)),console.log("用户名：".concat(e.username)),console.log("课程ID：".concat(e.selectedCourseId)),console.log("上传的文件数量：".concat(e.files.length)),o=localStorage.getItem("token"),a.next=26,i.a.post("http://182.92.182.44:8001/Course_selection/update_course/".concat(e.selectedCourseId,"/"),t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(o)}});case 26:r=a.sent,e.message=r.data.message,console.log("课程编辑成功:",r.data),e.uploadAdditionalData(),a.next=36;break;case 32:a.prev=32,a.t0=a["catch"](0),e.message="课程编辑失败: "+((null===(l=a.t0.response)||void 0===l||null===(l=l.data)||void 0===l?void 0:l.error)||"网络错误"),console.error("课程编辑失败:",a.t0);case 36:case"end":return a.stop()}}),a,null,[[0,32]])})))()},goToStudent:function(){this.$router.push({path:"/course/teacher"})},uploadAdditionalData:function(){var e=this;return Object(l["a"])(Object(s["a"])().mark((function a(){var t,o;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,t=new FormData,t.append("teacher_name",e.formData.teacherName),t.append("subject",e.formData.courseName),t.append("model",e.formData.modelType),a.next=7,i.a.post("http://api.xdrv.cn:52382/upload_teacher/",t,{headers:{"Content-Type":"multipart/form-data"}});case 7:o=a.sent,console.log("额外数据上传成功:",o.data),a.next=14;break;case 11:a.prev=11,a.t0=a["catch"](0),console.error("额外数据上传失败:",a.t0);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))()}}},u=m,d=(t("c1b4"),t("2877")),p=Object(d["a"])(u,o,r,!1,null,"4398a5db",null);a["default"]=p.exports},"7db0":function(e,a,t){"use strict";var o=t("23e7"),r=t("b727").find,s=t("44d2"),l=t("ae40"),n="find",c=!0,i=l(n);n in[]&&Array(1)[n]((function(){c=!1})),o({target:"Array",proto:!0,forced:c||!i},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),s(n)},a43d:function(e,a,t){},c1b4:function(e,a,t){"use strict";t("a43d")}}]);